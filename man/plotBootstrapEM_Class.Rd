\name{plotBootstrapEM_Class}
\alias{plotBootstrapEM_Class}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
  Plot results of bootstrapEM_Class
  %%  ~~function to do ... ~~
}
\description{
  %%  ~~ A concise (1-5 lines) description of what the function does. ~~
  Generates plots from a bootstrap EM classification. The plots show the
  results of the EM classification on the original data, with additional
  information on the uncertainty in the classification derived from the
  bootstrapping. 
}
\usage{
plotBootstrapEM_Class(bootClass, bootCurveAlpha = 0.05, subjectID = NULL)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{bootClass}{
    A list of bootstrap EM classification results from \code{bootstrapEM_Class}.
  }
  \item{bootCurveAlpha}{
    An alpha at which to plot the (two-sided) bootstrap confidence
    interval on the classification curve. 
  }
  \item{subjectID}{
    Optional vector of subject IDs, used for making the bar plot of EM vs
    bootstrap classification probabilities. The vector should match the
    length and ordering order of latencies passed to
    \code{bootstrapEM_Class}. If IDs are not specified, the subjects are
    numbered in ascending order.
  }
}
\details{
  %%  ~~ If necessary, more details than the description above ~~
  Three plots are generated by this function, entitled respectively

  \enumerate{

    \item Defeat latency and probability of classification as stress
    resilient
    
    This scatter plot shows the results of the Mclust EM classification on
    the original data set. The latency data points are plotted as circles,
    and the probability of LL classification as a continuous function of
    latency is plotted as a solid line.
    
    The dashed lines indicate the range of values for the solid curve over
    all bootstrap iterations. The default \code{bootCurveAlpha} of 0.05
    results in the 2.5th and 97.5th percentile being plotted.
    
    
    \item Stress resilience classification threshold over all bootstraps

    This histogram plots the EM classification threshold. The threshold
    is defined as the smallest latency (in the range 1:900) with an LL
    probability greater than 0.5.

    This plot is unreliable if the mixture models have unequal variance,
    because the probability of LL might not be monotonically increasing
    with latency and thus the wrong threshold may be chosen.

    
    \item Stress-resilience classification probabilities

    This bar plot shows, for each subject, the LL probabilities from the
    EM model fit to the original data, and from the results of the
    bootstrap. The bootstrap probabilities are defined as the
    probability the subject will be classified as LL for a given
    bootstrap. Thus if a subject is LL in 900 out of 1000 bootstraps,
    its bootstrap probability is 0.9. 
    
  }
  
}
\value{
  %%  ~Describe the value returned
  %%  If it is a LIST, use
  %%  \item{comp1 }{Description of 'comp1'}
  %%  \item{comp2 }{Description of 'comp2'}
  %% ...
}
\references{
  %% ~put references to the literature/web site here ~
}
\author{
  %%  ~~who you are~~
  Philip A Cook <cookpa@pennmedicine.upenn.edu>
}
\note{
  %%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
  %% ~~objects to See Also as \code{\link{help}}, ~~~
  \code{\link{bootstrapEM_Class}}
}
\examples{
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
